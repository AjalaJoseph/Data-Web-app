// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
  
}

model Datasource {
  id        Int      @id @default(autoincrement())
  planId    String   @unique
  name      String
  price     Decimal  @db.Decimal(18,2)
  type      String   // keep this if you want, or remove
  network   String   // <-- new field
  validity  String
  sellingprice Decimal  @db.Decimal(18,2)
  createdAt DateTime @default(now())
  updatedAt  DateTime  @updatedAt
}
model User{
  id          Int @id @default(autoincrement())
  name        String 
  email       String @unique
  phoneNumber String 
  password    String 
  role          String @default("user")
  wallet        Wallet?
  transactions  Transaction[]
  purchases      Purchase[]
  createdAt DateTime @default(now())
}
model Wallet {
  id               Int       @id @default(autoincrement())
  userId            Int       @unique
  reference          String?
  balance            Decimal   @default(0.00) @db.Decimal(18,2)
  currency           String    @default("NGN")
  updatedAt           DateTime  @updatedAt
  user                 User      @relation(fields: [userId], references: [id])
}
model Transaction {
  id            Int          @id @default(autoincrement())
  type          String       // 'fund', 'purchase', 'withdrawal'
  amount        Decimal      @db.Decimal(18, 2)
  status        String       @default("pending")
  reference     String      
  userId        Int         
  user          User         @relation(fields: [userId], references: [id])
  createdAt     DateTime     @default(now())
  
}
model Purchase {
  id            Int          @id @default(autoincrement())
  userId        Int 
  user          User          @relation(fields: [userId], references: [id]) 
  category      String        // 'data', 'airtime', 'tv', 'electricity', 'epin'
  network       String?       // MTN, DSTV, IKEDC, etc.
  plan          String?       // optional plan name or size
  phoneOrMeter  String?       // phone number, meter number, or smartcard
  amount        Decimal       @db.Decimal(18, 2)
  status        String        @default("processing")
  apiResponse   String?
  createdAt     DateTime      @default(now())
}
model Cableplan {
  id        Int      @id @default(autoincrement())
  provider   String
  plancode    String   @unique
  price     Decimal  @db.Decimal(18,2)
  display    String
  discription  String
  sellingprice Decimal  @db.Decimal(18,2)
  createdAt DateTime @default(now())
  updatedAt  DateTime  @updatedAt
}